{"ast":null,"code":"import { openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  id: \"container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, \" categoriesList \");\n}","map":{"version":3,"names":["id","_createElementBlock","_hoisted_1"],"sources":["C:\\Users\\Administrator\\Desktop\\小程序后台\\coffeeshop\\src\\components\\order\\categories.vue"],"sourcesContent":["<template>\r\n    <div id=\"container\">\r\n        categoriesList\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\n\r\nexport default {\r\n    name: 'categoriesList',\r\n    data() {\r\n        return {\r\n        }\r\n    },\r\n    methods: {\r\n       \r\n        async queryCloudDatabase() {\r\n            try {\r\n                const accessToken = await getAccessToken();\r\n                const query = {\r\n                    env: CONFIG.env,\r\n                    query: `db.collection('goods').skip(${(this.queryParam.page - 1) * this.queryParam.limit}).limit(${this.queryParam.limit}).get()`,\r\n                    totalQuery: \"db.collection('goods').count()\"\r\n                };\r\n                const [dataRes, countRes] = await Promise.all([\r\n                    axios.post(`/wechat-api/tcb/databasequery?access_token=${accessToken}`, { env: CONFIG.env, query: query.query }),\r\n                    axios.post(`/wechat-api/tcb/databasecount?access_token=${accessToken}`, { env: CONFIG.env, query: query.totalQuery })\r\n                ]);\r\n                const newData = dataRes.data.data.map(item => JSON.parse(item));\r\n                if (JSON.stringify(newData) !== JSON.stringify(this.goodsData)) {\r\n                    this.goodsData = newData;\r\n                    this.total = countRes.data.count;\r\n                }\r\n                return dataRes.data;\r\n            } catch (error) {\r\n                console.error('查询云数据库失败:', error);\r\n                throw error;\r\n            }\r\n        },\r\n\r\n        handleSizeChange(newSize) {\r\n            this.queryParam.limit = newSize;\r\n            this.queryCloudDatabase();\r\n        },\r\n        \r\n        handlePageChange(newPage) {\r\n            this.queryParam.page = newPage;\r\n            this.queryCloudDatabase();\r\n        }\r\n    },\r\n    mounted() {\r\n        this.queryCloudDatabase();\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n</script>\r\n<style scoped></style>"],"mappings":";;EACSA,EAAE,EAAC;AAAW;;uBAAnBC,mBAAA,CAEM,OAFNC,UAEM,EAFc,kBAEpB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}